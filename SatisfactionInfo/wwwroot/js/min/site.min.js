function loader(){$(".loader").toggleClass("hidden")}function log(e){console.log(e)}$(document).ready(function(){let e=parseInt($("#questionCount").val());if(!isNaN(e)){$("#questionnarieCode").val();let e=$("#questions").val().split(";").filter(Boolean).sort();for(var n=1;n<=e[e.length-1];n++){let e=n,o=$("#questionnarieCode").val(),d=$("#addWhyBody_"+String(e)).val();void 0===d&&(d=null);let i={Code:o,QuestionNumber:e,Answered:"",AddWhyBody:""};model[e-1]=i}}});let model=[];function updateAddWhyBody(e){model[e-1].AddWhyBody=$("#addWhyBody_"+String(e)).val()}function updateSimlpeAnswer(e,n){model[e-1].Answered=$(n).val(),model[e-1].Answered.length>0&&removeRequired(e)}function updateAnswer(e,n,o,d){model[e-1].Answered=calculateAnswered(model[e-1].Answered,o,n,d),model[e-1].Answered.length>0&&removeRequired(e)}function calculateAnswered(e,n,o,d){return"jednokrotny"===o||"numeryczny"===o?e=n:"wielokrotny"===o&&(null!=d&&d.checked?e+=n+";":e=String(e).replace(n+";","")),e}function validInput(){let e="Brak odpowiedzi w pytaniach: ",n=$("#questions").val().split(";").filter(Boolean).sort();for(var o=0;o<model.length;o++)!n.includes(String(model[o].QuestionNumber))||null!=model[o].Answered&&""!=model[o].Answered?removeRequired(String(model[o].QuestionNumber)):(e+=model[o].QuestionNumber+"; ",addRequired(String(model[o].QuestionNumber)));return"Brak odpowiedzi w pytaniach: "==e||e}function addRequired(e){$("#required_"+e).addClass("required")}function removeRequired(e){$("#required_"+e).removeClass("required")}function sendQuestionnarie(){if(!0!==validInput())return addInfo(3,validInput()),void window.scrollTo(0,0);toggleInfo(),$("#sendBtn").attr("disabled","disabled"),$("#questionnarieContent").toggleClass("hidden"),loader(),$.ajax({type:"POST",url:"/Home/AddUserQuestionnarie",data:{model:$.extend({},model)},success:function(e){location.href="/Home/?Type="+e.info.type+"&Message="+e.info.message,$("#sendBtn").removeAttr("disabled")},error:function(e){addInfo(3,"Nie udało się zapisać ankiety. Przepraszamy."),$("#sendBtn").removeAttr("disabled"),loader(),$("#questionnarieContent").toggleClass("hidden")}})}function toggleInfo(){$(".info").toggleClass("notVisible")}function addInfo(e,n){let o="";switch(e){case 1:o="info_msg";break;case 2:o="success_msg";break;case 3:o="danger_msg"}$(".info").html(""),$(".info").html('<div class="msg '+o+'"><div id="closeMsgJs" class="right fa fa-times-circle"></div>'+n+"</div>"),$(".info").removeClass("notVisible"),$("#closeMsgJs").on("click",toggleInfo)}$("document").ready(()=>{$("#closeMsg").on("click",toggleInfo)});